using Microsoft.VisualStudio.TestTools.UnitTesting;
using log4net.Config;
using com.bellarosa.ia.neuronalnetwork.image;
using System.Collections.Generic;
using System;

namespace com.bellarosa.ia.neuronalnetwork.number.image.Tests
{
    [TestClass()]
    public class ImageDataExtractionNeuronTests
    {
        #region Initializer / Cleanup
        [ClassInitialize]
        public static void classInitialize(TestContext testContext)
        {
            XmlConfigurator.Configure();
        }
        #endregion

        #region Tests
        [TestMethod()]
        public void processTest()
        {
            ImageData referenceImageData = new ImageData(new byte[] {
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,0,0, 0,0,0,0,0, 0,0,0,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,0,0, 0,0,0,0,0, 0,0,0,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,0,0,0,0, 0,0,0,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,0,0,0,0, 0,0,0,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,0,0, 0,0,0,0,0, 0,0,0,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,0,0, 0,0,0,0,0, 0,0,0,0,0, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,
                255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255,255,255, 255,255,255 }
                , 28, 28);

            ImageData testImage = new ImageData(@".\resources\3.bmp");
            object neuronResult = new ImageDataExtractionNeuron().process(new Dictionary<int, object> { { 1, testImage } });
            Assert.AreEqual(referenceImageData, neuronResult, "Test extract");
        }

        [TestMethod()]
        [ExpectedException(typeof(ArgumentException))]
        public void processTestArgumentNull()
        {
            new ImageDataExtractionNeuron().process(null);
        }

        [TestMethod()]
        [ExpectedException(typeof(ArgumentException))]
        public void processTestArgumentInvalidSize()
        {
            ImageData testInputData = new ImageData(new byte[] {
                0, 255, 255, 255, 0,
                255, 255, 255, 255, 255,
                255, 255, 0, 255, 255,
                255, 255, 255, 255, 255,
                0, 255, 255, 255, 0}, 10, 20);
            new ImageDataExtractionNeuron().process(new Dictionary<int, object> { { 1, testInputData } });
        }

        [TestMethod()]
        [ExpectedException(typeof(ArgumentException))]
        public void processTestArgumentDataNull()
        {
            ImageData nullDataImage = new ImageData(null, 0, 0);
            new ImageDataExtractionNeuron().process(new Dictionary<int, object> { { 1, nullDataImage } });
        }
        #endregion
    }
}